```SQL
WITH HAHA AS
 -- 깔끔하게 쓰려고 WITH절 씀
(SELECT B.HISTORY_ID, A.DAILY_FEE, A.CAR_TYPE, A.CAR_ID,
--  필요한 열들 다 뽑아주고
  (END_DATE - START_DATE +1) AS DURATION,
--  DURATION 열도 새로 만들어주고
  CASE
    WHEN END_DATE - START_DATE + 1 >= 90 THEN '0.85'
    WHEN END_DATE - START_DATE + 1 >= 30 THEN '0.92'
    WHEN END_DATE - START_DATE + 1 >= 7 THEN '0.95'
    ELSE '1'
  END AS DURATION_TYPE
--  저는 기간별로 마지막 테이블을 보고 직접 수치를 넣어줬는데 이렇게 풀면 안될것 같긴합니다. 
FROM (
  SELECT CAR_ID, DAILY_FEE, CAR_TYPE
  FROM CAR_RENTAL_COMPANY_CAR
  WHERE CAR_TYPE = '트럭'
) A
JOIN CAR_RENTAL_COMPANY_RENTAL_HISTORY B ON A.CAR_ID = B.CAR_ID)


SELECT HISTORY_ID, (DAILY_FEE*DURATION*DURATION_TYPE) FEE
FROM HAHA
ORDER BY 2 DESC,1 DESC
```

