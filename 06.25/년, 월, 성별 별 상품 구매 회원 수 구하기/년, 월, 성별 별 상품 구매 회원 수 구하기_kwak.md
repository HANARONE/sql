년, 월, 성별 별 상품 구매 회원 수 구하기_kwak



```sql
-- COUNT(DISTINCT(A.USER_ID)) => 중복값은 제거해야함 
SELECT TO_CHAR(SALES_DATE, 'YYYY') AS YEAR, TO_NUMBER(TO_CHAR(SALES_DATE, 'MM')) AS MONTH, 
B.GENDER AS GENDER, COUNT(DISTINCT(A.USER_ID)) AS USERS
-- ONLINE_SALE 테이블과 USER_INFO 테이블 INNER JOIN
FROM ONLINE_SALE A
INNER JOIN USER_INFO B 
-- 기준은 동일한 USER_ID
ON A.USER_ID = B.USER_ID
-- GROUP BY => A.SALES_DATE의 연도별, 월별(NUMBER로 해야 예시처럼 출력), 성별로 GROUP 화
GROUP BY TO_CHAR(A.SALES_DATE, 'YYYY'), TO_NUMBER(TO_CHAR(SALES_DATE, 'MM')), B.GENDER
-- B.GENDER가 NULL인 값은 미출력
HAVING B.GENDER IS NOT NULL
-- 년, 월, 성별 기준 정렬
ORDER BY YEAR, MONTH, GENDER
;
```

